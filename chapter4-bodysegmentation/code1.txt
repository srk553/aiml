/*
 * ğŸ‘‹ Hello! This is an ml5.js example made and shared with â¤ï¸.
 * Learn more about the ml5.js project: https://ml5js.org/
 * ml5.js license and Code of Conduct: https://github.com/ml5js/ml5-next-gen/blob/main/LICENSE.md
 *
 * This example demonstrates segmenting a person by body parts with ml5.bodySegmentation
 * â€” modified to use an image instead of video.
 */

let bodySegmentation;
let img;
let segmentation;

let options = {
  maskType: "parts", // "parts" shows body-part segmentation
};

function preload() {
  console.log("ğŸ“¥ Preloading assets...");
  // Load the image (replace with your own image path)
  img = loadImage("person.jpg", () => {
    console.log("âœ… Image loaded successfully!");
  });

  // Load the segmentation model
  console.log("âš™ï¸ Loading BodyPix model...");
  bodySegmentation = ml5.bodySegmentation("BodyPix", options, () => {
    console.log("âœ… Model loaded successfully!");
  });
}

function setup() {
  createCanvas(640, 480);
  console.log("ğŸ–¼ï¸ Canvas created (640x480).");

  // Run segmentation on the image once
  console.log("ğŸ” Running body segmentation on the image...");
  bodySegmentation.detect(img, gotResults);
}

function draw() {
  background(255);
  image(img, 0, 0, width, height);

  if (segmentation) {
    image(segmentation.mask, 0, 0, width, height);
  }
}

// callback function for body segmentation
function gotResults(result) {
  segmentation = result;
  console.log("ğŸ¯ Segmentation result received:", result);
}
